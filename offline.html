<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline - VibeLink 0372¬Æ</title>
    <style>
        :root {
            --vibe-black: #0D0D0D;
            --solar-flame-orange: #FF5A1F;
            --electric-cyan: #00E6E6;
            --earth-green: #009966;
            --sunrise-yellow: #FFD733;
            --royal-purple: #8E3AFF;
            --cloud-white: #F9F9F9;
            --solar-gradient: linear-gradient(135deg, #FF5A1F, #FFD733, #FF3333);
            --afro-tech-gradient: linear-gradient(135deg, #00E6E6, #8E3AFF, #0D0D0D);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--vibe-black);
            color: var(--cloud-white);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
        }

        .offline-container {
            text-align: center;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
        }

        .offline-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            filter: drop-shadow(0 0 30px var(--electric-cyan));
            animation: pulse 2s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); filter: drop-shadow(0 0 20px var(--electric-cyan)); }
            100% { transform: scale(1.05); filter: drop-shadow(0 0 40px var(--solar-flame-orange)); }
        }

        .offline-title {
            font-size: 3rem;
            font-weight: 900;
            background: var(--solar-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .offline-subtitle {
            font-size: 1.5rem;
            color: var(--sunrise-yellow);
            margin-bottom: 1.5rem;
        }

        .offline-message {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--royal-purple);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .offline-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--electric-cyan);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 230, 230, 0.3);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .feature-title {
            color: var(--electric-cyan);
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .offline-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .action-button {
            background: var(--solar-gradient);
            color: var(--vibe-black);
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 90, 31, 0.4);
        }

        .action-button.secondary {
            background: transparent;
            border: 2px solid var(--royal-purple);
            color: var(--cloud-white);
        }

        .action-button.secondary:hover {
            background: var(--royal-purple);
        }

        .connection-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            border-radius: 10px;
            background: rgba(255, 90, 31, 0.1);
            border: 1px solid var(--solar-flame-orange);
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--solar-flame-orange);
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .cached-content {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--earth-green);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .cached-content h3 {
            color: var(--earth-green);
            margin-bottom: 1rem;
        }

        .content-list {
            list-style: none;
            text-align: left;
        }

        .content-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .content-list li:last-child {
            border-bottom: none;
        }

        .watermark {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--cloud-white);
            opacity: 0.7;
            font-size: 0.8rem;
        }

        .watermark img {
            width: 20px;
            height: 20px;
            opacity: 0.7;
        }

        .retry-animation {
            display: none;
        }

        .retry-animation.active {
            display: block;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .offline-title {
                font-size: 2rem;
            }
            
            .offline-subtitle {
                font-size: 1.2rem;
            }
            
            .offline-actions {
                flex-direction: column;
            }
            
            .action-button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="offline-container">
        <svg class="offline-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <radialGradient id="globeGradient" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" stop-color="#00E6E6"/>
                    <stop offset="50%" stop-color="#8E3AFF"/>
                    <stop offset="100%" stop-color="#0D0D0D"/>
                </radialGradient>
                <filter id="glow">
                    <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                    <feMerge>
                        <feMergeNode in="coloredBlur"/>
                        <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                </filter>
            </defs>
            <circle cx="50" cy="50" r="45" fill="url(#globeGradient)" filter="url(#glow)"/>
            <path d="M 30,50 Q 50,30 70,50 Q 50,70 30,50 Z" fill="#FF5A1F" opacity="0.8"/>
            <circle cx="50" cy="50" r="15" fill="#FFD733" opacity="0.9"/>
            <path d="M 45,20 C 60,15 65,25 55,35" fill="none" stroke="#009966" stroke-width="2"/>
            <path d="M 55,20 C 40,15 35,25 45,35" fill="none" stroke="#009966" stroke-width="2"/>
        </svg>

        <h1 class="offline-title">VibeLink 0372¬Æ</h1>
        <h2 class="offline-subtitle">üåê Connection Lost</h2>

        <div class="connection-status">
            <div class="status-indicator"></div>
            <span>Attempting to reconnect...</span>
        </div>

        <div class="offline-message">
            <p>üö´ You're currently offline, but the vibe continues!</p>
            <p>VibeLink 0372 is designed to work seamlessly without an internet connection.</p>
        </div>

        <div class="offline-features">
            <div class="feature-card">
                <div class="feature-icon">üì±</div>
                <h3 class="feature-title">Browse Posts</h3>
                <p>Access your cached feed and read recent posts</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚úçÔ∏è</div>
                <h3 class="feature-title">Compose Content</h3>
                <p>Write posts and messages that will sync when online</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üí¨</div>
                <h3 class="feature-title">Read Messages</h3>
                <p>Access your recent chat conversations</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üí∞</div>
                <h3 class="feature-title">View Wallet</h3>
                <p>Check your balance and transaction history</p>
            </div>
        </div>

        <div class="offline-actions">
            <button class="action-button" onclick="retryConnection()">
                <span class="retry-icon">üîÑ</span>
                <span class="retry-text">Retry Connection</span>
                <span class="retry-animation">‚è≥</span>
            </button>
            <button class="action-button secondary" onclick="goToCachedHome()">
                üè† Continue Offline
            </button>
            <button class="action-button secondary" onclick="clearCacheAndRetry()">
                üóëÔ∏è Clear Cache & Retry
            </button>
        </div>

        <div class="cached-content">
            <h3>üìã Available Offline Content</h3>
            <ul class="content-list">
                <li>‚úÖ Home Dashboard</li>
                <li>‚úÖ Recent Posts (Cached)</li>
                <li>‚úÖ User Profiles</li>
                <li>‚úÖ Chat Messages</li>
                <li>‚úÖ Wallet Information</li>
                <li>‚úÖ Marketplace Items</li>
                <li>‚úÖ Learning Content</li>
                <li>‚úÖ Analytics Data</li>
            </ul>
        </div>

        <div class="network-info">
            <p><small>üîß <strong>Troubleshooting tips:</strong> Check your WiFi/mobile data, airplane mode, and try refreshing.</small></p>
        </div>
    </div>

    <div class="watermark">
        <svg width="20" height="20" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" fill="#00E6E6" opacity="0.7"/>
            <path d="M 30,50 Q 50,30 70,50 Q 50,70 30,50 Z" fill="#FF5A1F"/>
        </svg>
        <span>VibeLink 0372¬Æ</span>
    </div>

    <script>
        let retryCount = 0;
        const maxRetries = 5;

        // Check connection status on load
        window.addEventListener('load', function() {
            checkConnection();
            startConnectionMonitor();
        });

        function checkConnection() {
            if (navigator.onLine) {
                redirectToApp();
            } else {
                updateRetryCount();
            }
        }

        function startConnectionMonitor() {
            // Listen for online/offline events
            window.addEventListener('online', function() {
                console.log('üåê Connection restored - redirecting to app...');
                showConnectionRestored();
                setTimeout(redirectToApp, 2000);
            });

            window.addEventListener('offline', function() {
                console.log('üö´ Connection lost');
                showConnectionLost();
            });

            // Periodic connection check
            setInterval(() => {
                if (navigator.onLine && retryCount > 0) {
                    redirectToApp();
                }
            }, 5000);
        }

        function retryConnection() {
            retryCount++;
            const button = document.querySelector('.action-button');
            const retryText = button.querySelector('.retry-text');
            const retryIcon = button.querySelector('.retry-icon');
            const retryAnimation = button.querySelector('.retry-animation');

            // Show loading state
            retryText.textContent = `Retrying (${retryCount}/${maxRetries})`;
            retryIcon.style.display = 'none';
            retryAnimation.classList.add('active');
            button.disabled = true;

            // Simulate connection check
            setTimeout(() => {
                if (navigator.onLine) {
                    redirectToApp();
                } else {
                    // Reset button state
                    retryIcon.style.display = 'inline';
                    retryAnimation.classList.remove('active');
                    button.disabled = false;
                    
                    if (retryCount >= maxRetries) {
                        retryText.textContent = 'Max retries reached';
                        button.disabled = true;
                    } else {
                        retryText.textContent = 'Retry Connection';
                    }
                    
                    showRetryFailed();
                }
            }, 2000);
        }

        function redirectToApp() {
            // Try to redirect to the main app
            const mainAppUrl = window.location.pathname.replace('offline.html', 'index.html');
            
            // Add cache busting parameter to ensure fresh load
            const timestamp = new Date().getTime();
            window.location.href = `${mainAppUrl}?cachebust=${timestamp}`;
        }

        function goToCachedHome() {
            // Navigate to cached version of the app
            window.location.href = 'index.html';
        }

        function clearCacheAndRetry() {
            if ('caches' in window) {
                caches.keys().then(function(cacheNames) {
                    cacheNames.forEach(function(cacheName) {
                        caches.delete(cacheName);
                    });
                    
                    // Show confirmation
                    alert('üóëÔ∏è Cache cleared! The app will reload.');
                    window.location.reload();
                });
            } else {
                alert('‚ùå Cache API not supported in this browser.');
            }
        }

        function updateRetryCount() {
            const statusElement = document.querySelector('.connection-status span');
            statusElement.textContent = `Attempting to reconnect... (Retry ${retryCount}/${maxRetries})`;
        }

        function showConnectionRestored() {
            const statusElement = document.querySelector('.connection-status');
            statusElement.innerHTML = `
                <div class="status-indicator" style="background: #009966; animation: none;"></div>
                <span style="color: #009966;">‚úÖ Connection restored! Redirecting...</span>
            `;
        }

        function showConnectionLost() {
            const statusElement = document.querySelector('.connection-status');
            statusElement.innerHTML = `
                <div class="status-indicator"></div>
                <span>Connection lost. Retrying...</span>
            `;
        }

        function showRetryFailed() {
            const statusElement = document.querySelector('.connection-status');
            statusElement.innerHTML = `
                <div class="status-indicator" style="background: #FF5A1F; animation: none;"></div>
                <span style="color: #FF5A1F;">‚ùå Connection failed. Please check your network.</span>
            `;
        }

        // Service Worker registration for offline functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(function(registration) {
                    console.log('‚úÖ Service Worker registered:', registration);
                })
                .catch(function(error) {
                    console.log('‚ùå Service Worker registration failed:', error);
                });
        }

        // Display cached resources information
        function displayCachedResources() {
            if ('caches' in window) {
                caches.open('vibelink-0372-v1.0.0').then(function(cache) {
                    cache.keys().then(function(requests) {
                        const cachedCount = requests.length;
                        const statusElement = document.querySelector('.connection-status');
                        statusElement.innerHTML += ` <small>(${cachedCount} resources cached)</small>`;
                    });
                });
            }
        }

        // Initialize
        displayCachedResources();

        // Add vibration feedback if available
        function vibrate() {
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
        }

        // Add click handlers for tactile feedback
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', vibrate);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'r' || event.key === 'R') {
                if (event.ctrlKey || event.metaKey) {
                    event.preventDefault();
                    retryConnection();
                }
            }
            
            if (event.key === 'Enter' && event.target.tagName !== 'BUTTON') {
                retryConnection();
            }
        });

        console.log('üåê VibeLink 0372 Offline Page loaded');
        console.log('üîß Connection status:', navigator.onLine ? 'Online' : 'Offline');
        console.log('üì± User agent:', navigator.userAgent);
    </script>
</body>
</html>